---
import { Image } from "astro:assets";
import { getEntries, getEntry, render } from "astro:content";

import logo from "@/assets/svg/logo.svg";

import { Separator } from "@/components/ui/Separator";
import { Stack } from "@/components/ui/Stack";
import { Typography } from "@/components/ui/Typography";

const footer = await getEntry("footer", "default");

const socials = await getEntries(footer?.data.socials ?? []).then((entries) =>
  Promise.all(
    entries.map(async (social) => ({
      ...social,
      ...(await render(social)),
    })),
  ),
);

const links = await getEntries(footer?.data.links ?? []);
---

<footer class="container overflow-hidden py-24 lg:max-h-110">
  <Stack
    orientation="row"
    justify="between"
    align="center"
    className="max-lg:flex-col"
  >
    <Stack
      orientation="row"
      className="max-lg:mb-12 max-lg:flex-col lg:h-12"
      gap="lg"
      align="center"
    >
      <Image alt="ResX Logo" src={logo} class="h-auto w-34" />

      <Separator className="h-full max-lg:hidden" orientation="vertical" />

      {
        socials.length > 0 && (
          <Stack
            orientation="row"
            align="center"
            gap="sm"
            className="text-muted-foreground [&_a]:hover:text-primary"
          >
            <Typography variant="body" size="md" color="muted">
              Follow us on
            </Typography>

            {socials.map(({ data: { url }, Content }) => (
              <a
                href={url}
                class="inline-block transition-transform duration-150 ease-out hover:rotate-6"
              >
                <Content />
              </a>
            ))}
          </Stack>
        )
      }
    </Stack>

    <Stack
      orientation="row"
      className="[&>a]:text-muted-foreground [&>a]:hover:text-primary h-12 text-sm *:transition-all *:duration-300 max-lg:flex-col"
      gap="lg"
      align="center"
    >
      {links.map((link) => <a href={link.data.url}>{link.data.title}</a>)}
    </Stack>
  </Stack>

  <Image
    src={logo}
    alt="ResX Logo"
    class="mt-16 w-full mask-x-to-transparent opacity-75 grayscale"
  />
</footer>
