---
import { getCollection } from "astro:content";

import { Image } from "astro:assets";

import * as HowItWorks from "@/components/how-it-works";

import earn from "@/assets/earn.png";
import share from "@/assets/share.png";
import claim from "@/assets/claim.png";
import hero from "@/assets/hero.jpg";

import * as Hero from "@/components/hero";
import * as News from "@/components/news";
import * as Premium from "@/components/premium";
import * as Testimonials from "@/components/testimonials";
import * as SellingPoints from "@/components/selling-points";
import * as FAQ from "@/components/faq";

import PageLayout from "@/layouts/PageLayout.astro";

import { Heart, KeyVariant, Lock, PiggyBank, StarShooting } from "@/icons";
import RestaurantCarousel from "@/components/RestaurantCarousel.astro";
import TextAccent from "@/components/TextAccent.astro";

const articles = await getCollection("articles");

const faqs = (await getCollection("faq")).map((faq) => ({
  answer: faq.rendered?.html ?? "",
  id: faq.id,
  question: faq.data.question,
}));
---

<PageLayout title="Home">
  {/* Hero Section */}

  <Hero.Root>
    <Hero.Title
      className="animate-in fill-mode-both slide-in-from-bottom-10 fade-in inline-block duration-2000 ease-out"
      slot="title"
    >
      Plans changed?
      <TextAccent
        class="animate-in fill-mode-both slide-in-from-bottom-10 fade-in text-primary inline-block delay-130 duration-2000 ease-out"
      >
        Skip the fees.
      </TextAccent>
    </Hero.Title>

    <Hero.Subtitle slot="subtitle">
      <strong>Your canceled res is someone else’s dream dinner</strong> – share it
      with the ResX community and avoid unwanted cancellation fees.
    </Hero.Subtitle>

    <RestaurantCarousel slot="visual" />
  </Hero.Root>

  {/* How It Works Section */}

  <HowItWorks.Root>
    <HowItWorks.Header>
      How it <TextAccent>works</TextAccent>
    </HowItWorks.Header>
    <HowItWorks.StepList>
      <HowItWorks.Step
        title="Claim"
        description="Get the best tables in town without the weeks of planning."
      >
        <KeyVariant slot="icon" />
        <Image
          src={claim}
          layout="full-width"
          slot="image"
          class="object-bottom! max-lg:object-top!"
          alt="Claim"
        />
      </HowItWorks.Step>
      <HowItWorks.Step
        title="Share"
        description="Can't make your reservation? Share it and make someone's day."
      >
        <Heart slot="icon" />
        <Image
          src={share}
          class="object-top-right"
          layout="full-width"
          slot="image"
          alt="Share"
        />
      </HowItWorks.Step>
      <HowItWorks.Step
        title="Earn"
        description="Earn tokens with every booking and redeem them for exclusive rewards."
      >
        <StarShooting slot="icon" />
        <Image
          src={earn}
          class="object-[50%_70%] max-lg:object-[50%_20%]"
          layout="full-width"
          slot="image"
          alt="Earn"
        />
      </HowItWorks.Step>
    </HowItWorks.StepList>
  </HowItWorks.Root>

  <SellingPoints.Root>
    <SellingPoints.Title>
      The <TextAccent>smarter way</TextAccent> to cancel
    </SellingPoints.Title>
    <SellingPoints.List>
      <SellingPoints.Item
        title="No wasted tables. No lost money."
        description="Dodge cancellation fees by passing along your reservation to other hungry users."
      >
        <PiggyBank />
      </SellingPoints.Item>
      <SellingPoints.Item
        title="Effortless & secure"
        description="We handle the transaction securely from start to finish, so you can submit with confidence."
      >
        <Lock />
      </SellingPoints.Item>
      <SellingPoints.Item
        title="Join a community of trusted diners."
        description="Help restaurants avoid no-shows and fellow ResXers score their dream seats."
      >
        <Heart />
      </SellingPoints.Item>
    </SellingPoints.List>
  </SellingPoints.Root>

  {/* News Section */}

  <News.Root>
    <News.Title slot="title">
      Our users aren't the only ones <TextAccent>talking about us</TextAccent>
    </News.Title>
    <News.ArticleList slot="article-list">
      {articles.map((article) => <News.Article article={article} />)}
    </News.ArticleList>
  </News.Root>

  {/* FAQ Section */}

  <FAQ.Root>
    <FAQ.Title>
      Frequently Asked <TextAccent>Questions</TextAccent>
    </FAQ.Title>
    <FAQ.QuestionList client:visible questions={faqs} />
  </FAQ.Root>
</PageLayout>
